{"path":"api-docs/storefronts/guide/carts","templateID":0,"sharedPropsHashes":{"nav":"Z2k7O5R","sidebarTree":"Z1Jm3fi","namespace":"Zd6xn0"},"localProps":{"version":"1.3","crumbs":[{"content":"API Docs","to":"/api-docs"},{"content":"Building Headless Storefronts","to":"/api-docs/storefronts"},{"content":"Guide","to":"/api-docs/storefronts/guide"},{"content":"Managing Carts","to":"/api-docs/storefronts/guide/carts"}],"page":{"meta":{"title":"Managing Carts - Guide - Building Headless Storefronts - API Docs","url":"/api-docs/storefronts/guide/carts","description":"Managing Carts\n\n\n\nOn this page\n\nCreating a cart\n\nRedirecting to checkout\n\nDeleting a line item\n\nClearing the cart\n\nNext steps\n\nResources\n\n\n\nIn this sect..."},"title":"Managing Carts","parsedPath":["pages","/api-docs","data","children",6,"data","children",0,"data","children",3],"rootPagePath":"/api-docs","path":"/api-docs/storefronts/guide/carts","isSubpage":true,"route":{"path":"/carts"},"data":{"blocks":[{"type":"text","data":"# Managing Carts\n\n<div class=\"otp\" id=\"no-index\">\n\n### On this page\n- [Creating a cart](#creating-a-cart)\n- [Redirecting to checkout](#redirecting-to-checkout)\n- [Deleting a line item](#deleting-a-line-item)\n- [Clearing the cart](#clearing-the-cart)\n- [Next steps](#next-steps)\n- [Resources](#resources)\n\n</div>\n\nIn this section, we will explain how to use the Carts API to create and manage carts. Additionally, we will discuss how to redirect shoppers from a headless storefront to the BigCommerce hosted cart and checkout pages.\n\n## Creating a cart\n\nThe [Carts API](https://developer.bigcommerce.com/api-reference/store-management/carts) lets you create carts for both existing and guest customers. \n\nTo create a cart, send a `POST` request to the [Create a Cart](https://developer.bigcommerce.com/api-reference/store-management/carts/cart/createacart) endpoint.\n\n```http\nPOST https://api.bigcommerce.com/stores/{store_hash}/v3/carts\nAccept: application/json\nContent-Type: application/json\nX-Auth-Token: {{ACCESS_TOKEN}}\n```\n\n**Create a Cart request example**\n\n```json\n{\n    \"channel_id\": 704181,\n    \"line_items\": [\n        {\n            \"quantity\": 1,\n            \"product_id\": 80,\n            \"variant_id\": 64\n        }\n    ]\n}\n```\n\nTo create a cart for an existing customer, include the `customer_id` in your `POST` request.\n\n```json\n{\n    \"channel_id\": 704181,\n    \"customer_id\": 1,\n    \"line_items\": [\n        {\n            \"quantity\": 1,\n            \"product_id\": 80,\n            \"variant_id\": 64\n        }\n    ]\n}\n```\n\n[![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/carts/cart/createacart#requestrunner)\n\n<div class=\"HubBlock--callout\">\n<div class=\"CalloutBlock--info\">\n<div class=\"HubBlock-content\">\n\n> ### Note\n> The `id` returned in the response will correspond to the `cart_id` required to generate a cart redirect URL.\n\n</div>\n</div>\n</div>\n\n### Guest cart\n\nA guest cart assumes the shopper is not a customer and is not logging in or creating an account during checkout. You can handle guest carts by displaying the cart data to the customer and then moving them to checkout using the [Checkouts API](https://developer.bigcommerce.com/api-reference/store-management/checkouts).\n\n## Redirecting to checkout\n\nA cart redirect URL redirects a shopper to a BigCommerce hosted checkout page. You can generate a cart redirect URL only from a cart created using the Carts API.\n\nTo generate a cart redirect URL, send a `POST` request to the [Create Cart Redirect URL](https://developer.bigcommerce.com/api-reference/store-management/carts/cart-redirect-urls/createcartredirecturl) endpoint. Use the `id` returned in the [Create a Cart](https://developer.bigcommerce.com/api-reference/store-management/carts/cart/createacart) response for the `cartId` path parameter.\n\n```http\nPOST https://api.bigcommerce.com/stores/{store_hash}/v3/carts/{cartId}/redirect_urls\nAccept: application/json\nContent-Type: application/json\nX-Auth-Token: {{ACCESS_TOKEN}}\n```\n\n[![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/carts/cart-redirect-urls/createcartredirecturl#requestrunner)\n\nThe response will contain `cart_url` and `checkout_url` parameters - use these URLs to redirect the customer to the BigCommerce hosted cart or checkout pages. You can use the `embedded_checkout_url` with the [Checkout SDK](https://developer.bigcommerce.com/stencil-docs/customizing-checkout/checkout-sdk) to embed the BigCommerce hosted checkout into a headless site via an iFrame.\n\n```json\n{\n  \"cart_url\": \"https://store-id30h7ohwf.mybigcommerce.com/cart.php?action=load&id=bc218c65-7a32-4ab7-8082-68730c074d02&token=aa958e2b7922035bf3339215d95d145ebd9193deb36ae847caa780aa2e003e4b\",\n  \"checkout_url\": \"https://store-id30h7ohwf.mybigcommerce.com/cart.php?action=loadInCheckout&id=bc218c65-7a32-4ab7-8082-68730c074d02&token=aa958e2b7922035bf3339215d95d145ebd9193deb36ae847caa780aa2e003e4b\",\n  \"embedded_checkout_url\": \"https://store-id30h7ohwf.mybigcommerce.com/cart.php?embedded=1&action=loadInCheckout&id=bc218c65-7a32-4ab7-8082-68730c074d02&token=aa958e2b7922035bf3339215d95d145ebd9193deb36ae847caa780aa2e003e4b\"\n}\n```\n\n### Creating a redirect using the include query parameter\n\nIt is possible to generate a redirect URL when creating a cart using the [Create a Cart](https://developer.bigcommerce.com/api-reference/store-management/carts/cart/createacart) endpoint by appending the `include=redirect_urls` query parameter to the request URL.\n\n```http\nPOST https://api.bigcommerce.com/stores/{store_hash}/v3/carts?include=redirect_urls\nAccept: application/json\nContent-Type: application/json\nX-Auth-Token: {{ACCESS_TOKEN}}\n```\n\n### Logging in and redirecting a customer\n\nIf you passed the `customer_id` in the [Create a Cart](https://developer.bigcommerce.com/api-reference/store-management/carts/cart/createacart) request, redirect the customer to the login URL first before redirecting them to the cart or checkout pages. To do so, create a customer login JWT using the same `customer_id` and set the `redirect_to` parameter to the relative path of the desired redirect URL. \n\n**Customer login JWT payload example**\n\n```js\n{\n  \"iss\": {{CLIENT_ID}},\n  \"iat\": 1535393113,\n  \"jti\": {{UUID}},\n  \"operation\": \"customer_login\",\n  \"store_hash\": {{STORE_HASH}},\n  \"customer_id\": {{CUSTOMER_ID}},\n  \"channel_id\": {{CHANNEL_ID}},\n  \"redirect_to\": \"/cart.php?embedded=1&action=loadInCheckout&id=bc218c65-7a32-4ab7-8082-68730c074d02&token=aa958e2b7922035bf3339215d95d145ebd9193deb36ae847caa780aa2e003e4b\",\n  \"request_ip\": \"111.222.333.444\"\n}\n```\n\nUse the payload to generate the customer login JWT. Then, create a customer login URL by appending the JWT to `https://{{YOUR_BIGCOMMERCE_DOMAIN}}.com/login/token/`. \n\nFor example:\n\n`https://store.example.com/login/token/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ7Y2xpZW50X2lkfSIsImlhdCI6MTUzNTM5MzExMywianRpIjoie3V1aWR9Iiwib3BlcmF0aW9uIjoiY3VzdG9tZXJfbG9naW4iLCJzdG9yZV9oYXNoIjoie3N0b3JlX2hhc2h9IiwiY3VzdG9tZXJfaWQiOjJ9.J-fAtbjRFGdLsT744DhoprFEDqIfVq72HbDzrbFy6Is`\n\nThe customer login JWT must include a `channel_id` property. If you omit the `channel_id`, CORS checks will fail and the checkout will not load.\n\nIf you are using [Embedded Checkout](https://developer.bigcommerce.com/api-docs/storefronts/embedded-checkout/embedded-checkout-overview), pass the customer login URL to the Checkout SDK to log in the customer, then redirect to checkout within the embedded checkout iFrame.\n\n## Deleting a line item\n\nTo delete a line item from a cart, send a `DELETE` request to the [Delete Cart Line Item](https://developer.bigcommerce.com/api-reference/store-management/carts/cart-items/deletecartlineitem) endpoint passing in the associated `cartId` and `itemId`.\n\n```http\nDELETE https://api.bigcommerce.com/stores/{store_hash}/v3/carts/{cartId}/items/{itemId}\nAccept: application/json\nContent-Type: application/json\nX-Auth-Token: {{ACCESS_TOKEN}}\n```\n\n[![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/carts/cart-items/deletecartlineitem#requestrunner)\n\n## Clearing the cart\n\nRemoving all cart items essentially deletes the cart. To clear the cart, call the [Delete a Cart](https://developer.bigcommerce.com/api-reference/store-management/carts/cart/deleteacart) endpoint.\n\n```http\nDELETE https://api.bigcommerce.com/stores/{store_hash}/v3/carts/{cartId}\nAccept: application/json\nContent-Type: application/json\nX-Auth-Token: {{ACCESS_TOKEN}}\n```\n\n[![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/carts/cart/deleteacart#requestrunner)\n\n## Next steps\n\n- [Learn how to move a cart to checkout](https://developer.bigcommerce.com/api-docs/storefronts/guide/checkout)\n\n## Resources\n\n- [Carts API](https://developer.bigcommerce.com/api-reference/store-management/carts)\n- [Storefront Carts API](https://developer.bigcommerce.com/api-reference/storefront/carts)\n- [Persistent Cart](https://support.bigcommerce.com/s/article/Persistent-Cart)"}],"children":[]}}}}
