{"path":"api-docs/storefronts/guide/orders","templateID":0,"sharedPropsHashes":{"nav":"Z2k7O5R","sidebarTree":"Z1Jm3fi","namespace":"Zd6xn0"},"localProps":{"version":"1.3","crumbs":[{"content":"API Docs","to":"/api-docs"},{"content":"Building Headless Storefronts","to":"/api-docs/storefronts"},{"content":"Guide","to":"/api-docs/storefronts/guide"},{"content":"Handling Orders","to":"/api-docs/storefronts/guide/orders"}],"page":{"meta":{"title":"Handling Orders - Guide - Building Headless Storefronts - API Docs","url":"/api-docs/storefronts/guide/orders","description":"Handling Orders\n\n\n\nOn this page\n\nCreating an order from a cart\n\nProcessing payments\n\nNext steps\n\nResources\n\n\n\nThis section explains how to create and ma..."},"title":"Handling Orders","parsedPath":["pages","/api-docs","data","children",6,"data","children",0,"data","children",7],"rootPagePath":"/api-docs","path":"/api-docs/storefronts/guide/orders","isSubpage":true,"route":{"path":"/orders"},"data":{"blocks":[{"type":"text","data":"# Handling Orders\n\n<div class=\"otp\" id=\"no-index\">\n\n### On this page\n- [Creating an order from a cart](#creating-an-order-from-a-cart)\n- [Processing payments](#processing-payments)\n- [Next steps](#next-steps)\n- [Resources](#resources)\n\n</div>\n\nThis section explains how to create and manage orders for headless storefronts.\n\n## Creating an order from a cart\n\nTo successfully complete this section, you must first create a cart with a **redirect URL**. For instructions on how to create a cart, see the [Carts]() section of this tutorial.\n\n### Adding a billing address\n\nYou can change a cart to a checkout by adding a billing address. To add a checkout billing address, send a `POST` request to the [Add Checkout Billing Address](https://developer.bigcommerce.com/api-reference/store-management/checkouts/checkout-billing-address/checkoutsbillingaddressbycheckoutidpost) endpoint. Your `checkoutId` will correspond with the cart `id` returned in response to [Create a Cart](https://developer.bigcommerce.com/api-reference/store-management/carts/cart/createacart).\n\n```http\nPOST https://api.bigcommerce.com/stores/{store_hash}/v3/checkouts/{checkoutId}/billing-address\nAccept: application/json\nContent-Type: application/json\nX-Auth-Token: {{ACCESS_TOKEN}}\n\n{\n  \"first_name\": \"Jane\",\n  \"last_name\": \"Doe\",\n  \"email\": \"jane@example.com\",\n  \"address1\": \"123 Main Street\",\n  \"address2\": \"\",\n  \"city\": \"Austin\",\n  \"state_or_province\": \"Texas\",\n  \"state_or_province_code\": \"TX\",\n  \"country_code\": \"US\",\n  \"postal_code\": \"78751\",\n  \"phone\": \"1234567890\"\n}\n```\n\n[![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/checkouts/checkout-billing-address/checkoutsbillingaddressbycheckoutidpost#requestrunner)\n\n### Adding a consignment\n\nNow that you have transformed your headless cart into a checkout, you need to add a consignment with a shipping address, line items, and a shipping option. You can do so following this two-step process:\n\n**Step 1: Add a new consignment to the checkout**\n\nSend a `POST` request to the [Add Consignment to Checkout](https://developer.bigcommerce.com/api-reference/store-management/checkouts/checkout-consignments/checkoutsconsignmentsbycheckoutidpost) endpoint. Append the `include=consignments.available_shipping_options` query parameter to your `POST` request to return `available_shipping_options` (required for step two).\n\n```http\nPOST https://api.bigcommerce.com/stores/{store_hash}/v3/checkouts/{checkoutId}/consignments?include=consignments.available_shipping_options\nAccept: application/json\nContent-Type: application/json\nX-Auth-Token: {{ACCESS_TOKEN}}\n\n[\n  {\n    \"shipping_address\": {\n      \"first_name\": \"Jane\",\n      \"last_name\": \"Doe\",\n      \"email\": \"jane@example.com\",\n      \"address1\": \"123 Main Street\",\n      \"address2\": \"\",\n      \"city\": \"Austin\",\n      \"state_or_province\": \"Texas\",\n      \"state_or_province_code\": \"TX\",\n      \"country_code\": \"US\",\n      \"postal_code\": \"78751\",\n      \"phone\": \"1234567890\"\n    },\n    \"line_items\": [\n      {\n        \"item_id\": \"7e2f9b22-a16e-4056-9e2d-8fc919bcf653\",\n        \"quantity\": 1\n      }\n    ]\n  }\n]\n```\n\nThe response will contain an array of `available_shipping_options`. You will use one of the available shipping options to update the consignment in the next step.\n\n```json\n\"available_shipping_options\": [\n  {\n    \"id\": \"80ad65f7946c23bd4ee9a531d85c5e21\",\n    \"type\": \"shipping_pickupinstore\",\n    \"description\": \"Pickup In Store\",\n    \"image_url\": \"\",\n    \"cost\": 0,\n    \"transit_time\": \"\",\n    \"additional_description\": \"\"\n  },\n  {\n    \"id\": \"4dcbf24f457dd67d5f89bcf374e0bc9b\",\n    \"type\": \"freeshipping\",\n    \"description\": \"Free Shipping\",\n    \"image_url\": \"\",\n    \"cost\": 0,\n    \"transit_time\": \"\",\n    \"additional_description\": \"\"\n  },\n  {\n    \"id\": \"85dfaf5f834d7e594f0bd7cf67d5b200\",\n    \"type\": \"shipping_flatrate\",\n    \"description\": \"Flat Rate\",\n    \"image_url\": \"\",\n    \"cost\": 5,\n    \"transit_time\": \"\",\n    \"additional_description\": \"\"\n  },\n  {\n    \"id\": \"8809b0bbcc8bdc2d5cad2a4fcbd6cf09\",\n    \"type\": \"shipping_byweight\",\n    \"description\": \"Ship by Weight\",\n    \"image_url\": \"\",\n    \"cost\": 10,\n    \"transit_time\": \"\",\n    \"additional_description\": \"\"\n  }\n]\n```\n\n**Step 2: Update the consignment**\n\nUse one of the available shipping options to update the consignment you created in Step 1.\nSend a `PUT` request to the [Update Checkout Consignment](https://developer.bigcommerce.com/api-reference/store-management/checkouts/checkout-consignments/checkoutsconsignmentsbycheckoutidandconsignmentidput) endpoint.\n\n```http\nPUT https://api.bigcommerce.com/stores/{store_hash}/v3/checkouts/{checkoutId}/consignments/{consignmentId}\nAccept: application/json\nContent-Type: application/json\nX-Auth-Token: {{ACCESS_TOKEN}}\n\n{\n  \"shipping_option_id\": \"4dcbf24f457dd67d5f89bcf374e0bc9b\"\n}\n```\n\n[![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/checkouts/checkout-consignments/checkoutsconsignmentsbycheckoutidandconsignmentidput#requestrunner)\n\n### Creating an order\n\nNow that you have added a billing address and a consignment to your checkout, you can create an order by sending a `POST` request to the [Create an Order](https://developer.bigcommerce.com/api-reference/store-management/checkouts/checkout-orders/createanorder) endpoint. The order status will be set to incomplete.\n\n```http\nPOST https://api.bigcommerce.com/stores/{store_hash}/v3/checkouts/{checkoutId}/orders\nAccept: application/json\nContent-Type: application/json\nX-Auth-Token: {{ACCESS_TOKEN}}\n```\n\n[![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/checkouts/checkout-orders/createanorder#requestrunner)\n\n**Response example**\n\n```json\n{\n  \"data\": {\n    \"id\": 125\n  },\n  \"meta\": {}\n}\n```\n\n## Processing payments\n\nDepending on the shopper's card-on-file authorization, you can use one of the following methods to process the payment.\n\n* **Stored Card** – A shopper has authorized a merchant to store their payment details.\n* **Credit Card** – A shopper has not authorized a merchant to store their payment details.\n\n### Using the Stored Card method\n\n1. Start by retrieving the available payment methods. Send a `GET` request to the `Get Accepted Payment Methods` endpoint. \n\n```http\nGET https://api.bigcommerce.com/stores/{store_hash}/v3/payments/methods\nAccept: application/json\nContent-Type: application/json\nX-Auth-Token: {{ACCESS_TOKEN}}\n```\n\n[![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/payment-processing/accepted-methods/paymentsmethodsget#requestrunner)\n\n2. To process a payment for an order, you will need to make a call to the Payments API which requires an access token. To generate an access token, send a `POST` request to the [Create Payment Access Token](https://developer.bigcommerce.com/api-reference/store-management/payment-processing/access-tokens/paymentsaccesstokenspost) endpoint. \n\n```http\nPOST https://api.bigcommerce.com/stores/{store_hash}/v3/payments/access_tokens\nAccept: application/json\nContent-Type: application/json\nX-Auth-Token: {{ACCESS_TOKEN}}\n\n{\n  \"order\": {\n    \"id\": 125,\n    \"is_recurring\": false\n  }\n}\n```\n\n[![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/payment-processing/access-tokens/paymentsaccesstokenspost#requestrunner)\n\nMake a note of the access token `id`. This token is required in subsequent payment request to the [Process Payment](https://developer.bigcommerce.com/api-reference/store-management/payment-processing/process-payment/paymentspost) endpoint.\n\n3. Send a `POST` request to the [Process Payment](https://developer.bigcommerce.com/api-reference/store-management/payment-processing/process-payment/paymentspost) endpoint. The headers to process a payment are different than the headers you normally send with a BigCommerce API. The authorization token is the ID returned in Create Payment Access Token (step two). To learn more, see [Stored cards](https://developer.bigcommerce.com/api-docs/store-management/payment-processing#stored-cards).\n\n```http\nPOST https://api.bigcommerce.com/stores/{store_hash}/payments\nAccept: application/json\nContent-Type: application/json\nX-Auth-Token: {{ACCESS_TOKEN}}\n\n{\n  \"payment\": {\n    \"instrument\": {\n      \"type\": \"stored_card\",\n      \"token\": \"8cdf7b6ea1b27119463bf9e5106639618cc77a9adc49f0069ca8b756cc15caee\",\n      \"verification_value\": \"1142\"\n    },\n    \"payment_method_id\": \"adyenv2.scheme\",\n    \"save_instrument\": true\n  }\n}\n```\n\n**Example response**\n\n```json\n{\n  \"data\": {\n    \"id\": \"693bb4cd-3f20-444a-8315-6369f582c68a\",\n    \"status\": \"success\",\n    \"transaction_type\": \"purchase\"\n  }\n}\n```\n\n### Using the Credit Card method\n\nIf a shopper does not have a payment method saved on file, you can process a payment using a credit card. There are two steps to this method:\n\n1. Send a `POST` request to the [Create Payment Access Token](https://developer.bigcommerce.com/api-reference/store-management/payment-processing/access-tokens/paymentsaccesstokenspost) endpoint to get the authorization token that needs to be passed in the header when processing the payment.\n\n2. Send a `POST` request to the [Process Payment](https://developer.bigcommerce.com/api-reference/store-management/payment-processing/process-payment/paymentspost) endpoint. The headers to process a payment are different than the headers you normally send with a BigCommerce API. The Authorization token is the ID returned in Create Payment Access Token (step one). To learn more, see [Credit cards](https://developer.bigcommerce.com/api-docs/store-management/payment-processing#credit-cards).\n\n**Example response**\n\n```json\n{\n  \"data\": {\n    \"id\": \"693bb4cd-3f20-444a-8315-6369f582c68a\",\n    \"status\": \"success\",\n    \"transaction_type\": \"purchase\"\n  }\n}\n```\n\nA successful transaction will return a status of success. The order is then automatically moved to an Awaiting Fulfillment status. If you get a different response, see [Error Codes](https://developer.bigcommerce.com/api-docs/store-management/payment-processing#error-codes) for troubleshooting.\n\n## Next steps\n\n- [Learn more about PCI compliance](https://developer.bigcommerce.com/api-docs/storefronts/guide/pci-compliance)\n\n## Resources\n\n- [Payments API Overview](https://developer.bigcommerce.com/api-docs/store-management/payment-processing)"}],"children":[]}}}}
