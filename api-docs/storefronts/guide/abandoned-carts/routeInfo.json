{"path":"api-docs/storefronts/guide/abandoned-carts","templateID":0,"sharedPropsHashes":{"nav":"Z2k7O5R","sidebarTree":"Z1Jm3fi","namespace":"Zd6xn0"},"localProps":{"version":"1.3","crumbs":[{"content":"API Docs","to":"/api-docs"},{"content":"Building Headless Storefronts","to":"/api-docs/storefronts"},{"content":"Guide","to":"/api-docs/storefronts/guide"},{"content":"Recovering Abandoned Carts","to":"/api-docs/storefronts/guide/abandoned-carts"}],"page":{"meta":{"title":"Recovering Abandoned Carts - Guide - Building Headless Storefronts - API Docs","url":"/api-docs/storefronts/guide/abandoned-carts","description":"Recovering Abandoned Carts\n\n\n\nOn this page\n\nAbandoned Cart Saver\n\nSetting up the abandoned cart route\n\nLeveraging the Abandoned Carts API\n\nImplementing ..."},"title":"Recovering Abandoned Carts","parsedPath":["pages","/api-docs","data","children",6,"data","children",0,"data","children",4],"rootPagePath":"/api-docs","path":"/api-docs/storefronts/guide/abandoned-carts","isSubpage":true,"route":{"path":"/abandoned-carts"},"data":{"blocks":[{"type":"text","data":"# Recovering Abandoned Carts\n\n<div class=\"otp\" id=\"no-index\">\n\n### On this page\n\n- [Abandoned Cart Saver](#abandoned-cart-saver)\n- [Setting up the abandoned cart route](#setting-up-the-abandoned-cart-route)\n- [Leveraging the Abandoned Carts API](#leveraging-the-abandoned-carts-api)\n- [Implementing cart recovery on headless storefronts](#implementing-cart-recovery-on-headless-storefronts)\n- [Resources](#resources)\n\n</div>\n\nBigCommerce offers a powerful cart recovery system to help merchants recover lost business by effectively converting abandoned carts into orders. Using BigCommerce's built-in [Abandoned Cart Saver](https://support.bigcommerce.com/s/article/Using-the-Abandoned-Cart-Saver?language=en_US) tool, merchants can automate email campaigns to encourage customers to complete transactions after leaving items in their cart.\n\nThis article provides a high-level overview of how headless storefronts can leverage the Abandoned Cart Saver and BigCommerce's APIs to recover abandoned carts.\n\n## Abandoned Cart Saver\n\nBigCommerce considers a cart _abandoned_ when a shopper leaves the cart without attempting payment and the cart has been inactive for one hour. [Abandoned Cart Saver](https://support.bigcommerce.com/s/article/Using-the-Abandoned-Cart-Saver?language=en_US) emails contain a link that routes shoppers back to the cart page where they can complete the order.\n\n![Complete your purchase email](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Abandoned%20Carts/01-abandoned-carts.png \"Complete your purchase email\")\n\nTo enable the Abandoned Cart Saver notifications on your store, go to **Store Setup > Store Settings > Miscellaneous** in the control panel. To access your Abandoned Cart Emails settings, visit **Marketing > Abandoned Cart Emails**.\n\n![Abandoned cart emails](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Abandoned%20Carts/02-abandoned-carts.png \"Abandoned cart emails\")\n\n### Triggering Abandoned Cart Saver notifications\n\nThe Abandoned Cart Saver will trigger under the following circumstances:\n\n- **Stencil stores**: a logged-in customer adds an item to the cart, then leaves the store without attempting payment.\n- **Stores using [Optimized One-Page Checkout](https://support.bigcommerce.com/s/article/Optimized-Single-Page-Checkout?language=en_US)**: a guest customer adds an item to the cart, begins checkout by entering their email address, then leaves the store without attempting payment.\n- **Headless stores using custom checkout solutions**:\n  - a logged-in customer with the `accepts_product_review_abandoned_cart_email` property set to `true` creates a cart, then leaves the store without attempting payment.\n  - a guest customer creates a cart and add his email address to the cart, then leaves the store without attempting payment.\n\n## Setting up the abandoned cart route\n\nThe Abandoned Cart Saver email link points to the Stencil storefront (channel ID 1) by default. To point the Abandoned Cart Saver email link to your headless storefront, you need to set up a `recover_abandoned_cart` site route.\n\nThis operation requires a channel site ID. If you do not know your channel site ID, you can retrieve it by sending a `GET` request to the [Get a Channel Site](https://developer.bigcommerce.com/api-reference/store-management/channels/channel-site/get-channel-site) endpoint.\n\n```http\nGET https://api.bigcommerce.com/stores/{{STORE_HASH}}/v3/channels/{channel_id}/site\nX-Auth-Token: {{ACCESS_TOKEN}}\nContent-Type: application/json\nAccept: application/json\n\n```\n\n[![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/channels/channel-site/get-channel-site#requestrunner)\n\n**Example response**\n\n```json\n{\n  \"data\": {\n    \"channel_id\": 773240,\n    \"created_at\": \"2021-08-23T20:02:11Z\",\n    \"id\": 1001,\n    \"updated_at\": \"2021-08-23T20:02:11Z\",\n    \"url\": \"http://commerce-zr8y-teststore-bigcommerce.vercel.app\"\n  },\n  \"meta\": {}\n}\n```\n\nYou can locate your channel ID by:\n\n- going to **Channel Manager > Storefronts** in the control panel, clicking on **...** next to your headless storefront, and selecting **Advanced settings** from the dropdown\n\n**or**\n\n- sending a `GET` request to the [Get All Channels](https://developer.bigcommerce.com/api-reference/store-management/channels/channels/listchannels) endpoint.\n\nTo create a `recover_abandoned_cart` site route, send a `POST` request to the [Create a Site Route](https://developer.bigcommerce.com/api-reference/store-management/sites/site-routes/post-site-route) endpoint.\n\n```http\nPOST https://api.bigcommerce.com/stores/{{STORE_HASH}}/v3/sites/{site_id}/routes\nX-Auth-Token: {{ACCESS_TOKEN}}\nContent-Type: application/json\nAccept: application/json\n\n{\n \"type\": \"recover_abandoned_cart\",\n \"matching\": \"*\",\n \"route\": \"/my-abandoned-cart-page/\"\n}\n```\n\n[![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/sites/site-routes/post-site-route#requestrunner)\n\n**Example response**\n\n```json\n{\n  \"data\": {\n    \"id\": 11,\n    \"type\": \"recover_abandoned_cart\",\n    \"matching\": \"*\",\n    \"route\": \"/my-abandoned-cart-page/\",\n    \"created_at\": \"2021-08-25T18:36:05Z\",\n    \"updated_at\": \"2021-08-25T18:36:05Z\"\n  },\n  \"meta\": {}\n}\n```\n\nTo test the route creation, send a `GET` request to the [Get a Site's Routes](https://developer.bigcommerce.com/api-reference/store-management/sites/site-routes/index-site-routes) endpoint. The response will contain all of the routes associated with your headless storefront's domain.\n\n## Leveraging the Abandoned Carts API\n\nThe Abandoned Cart Saver email link contains a token in the form of a `t` parameter that you can use to call the [Abandoned Carts API](https://developer.bigcommerce.com/api-reference/store-management/abandoned-carts/abandoned-carts/getabandonedcarts) to get the corresponding cart ID. A headless storefront can then use this cart ID to request the cart details from the [Carts API](https://developer.bigcommerce.com/api-reference/store-management/carts).\n\n**Abandoned Cart Saver email link example**:\n\n`http://commerce-zr8y-teststore-bigcommerce.vercel.app/my-abandoned-cart-page/?t=305c6c15f6f0a3c0929770a538cf1ff7`\n\nTo get the abandoned cart ID, send a `GET` request to the [Get an Abandoned Cart](https://developer.bigcommerce.com/api-reference/store-management/abandoned-carts/abandoned-carts/getabandonedcarts) endpoint.\n\n```http\nGET https://api.bigcommerce.com/stores/{{STORE_HASH}}/v3/abandoned-carts/{token}\nX-Auth-Token: {{ACCESS_TOKEN}}\nContent-Type: application/json\nAccept: application/json\n\n```\n\n[![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/abandoned-carts/abandoned-carts/getabandonedcarts#requestrunner)\n\nThe response will contain the corresponding cart ID.\n\n```json\n{\n  \"data\": {\n    \"cart_id\": \"74cd7d0a-c748-4efa-b9bf-cf15751e78b2\"\n  },\n  \"meta\": {}\n}\n```\n\nTo retrieve the cart details, send a `GET` request to the [Get a Cart](https://developer.bigcommerce.com/api-reference/store-management/carts/cart/getacart) endpoint.\n\n```http\nGET https://api.bigcommerce.com/stores/{{STORE_HASH}}/v3/carts/{cartId}\nX-Auth-Token: {{ACCESS_TOKEN}}\nContent-Type: application/json\nAccept: application/json\n\n```\n\n[![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/carts/cart/getacart#requestrunner)\n\nThe response will contain the cart details.\n\n## Implementing cart recovery on headless storefronts\n\nTo trigger the abandoned cart recovery sequence, the cart must be associated with a channel ID and be aware of the shopper's email address. Headless storefronts using custom checkout solutions can leverage BigCommerce's [Customers](https://developer.bigcommerce.com/api-reference/store-management/customers-v3) and [Carts](https://developer.bigcommerce.com/api-reference/store-management/carts) APIs to initiate the abandoned cart recovery sequence.\n\nThe following example demonstrates how a headless storefront can recover abandoned cart details without relying on Optimized One-Page Checkout.\n\n1. Link your headless storefront to your sales channel by sending a `POST` request to the [Create a Site](https://developer.bigcommerce.com/api-reference/store-management/sites/sites/post-site) endpoint.\n\n   ```http\n   POST https://api.bigcommerce.com/stores/{{STORE_HASH}}/v3/sites\n   X-Auth-Token: {{ACCESS_TOKEN}}\n   Content-Type: application/json\n   Accept: application/json\n\n   {\n     \"url\": \"http://commerce-zr8y-teststore-bigcommerce.vercel.app\",\n     \"channel_id\": 773240\n   }\n   ```\n\n   [![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/sites/sites/post-site#requestrunner)\n\n2. Using the [Site Routes](https://developer.bigcommerce.com/api-reference/store-management/sites/site-routes/post-site-route) endpoint, create a `recover_abandoned_cart` route.\n\n   ```http\n   POST https://api.bigcommerce.com/stores/{{STORE_HASH}}/v3/sites/{site_id}/routes\n   X-Auth-Token: {{ACCESS_TOKEN}}\n   Content-Type: application/json\n   Accept: application/json\n\n   {\n     \"matching\": \"*\",\n     \"route\": \"/my-abandoned-cart-page/\",\n     \"type\": \"recover_abandoned_cart\"\n   }\n\n   ```\n\n   [![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/sites/site-routes/post-site-route#requestrunner)\n\n### Create cart with customer\n\n1. To create a customer, send a `POST` request to the [Create Customers](https://developer.bigcommerce.com/api-reference/store-management/customers-v3/customers/customerspost) endpoint. In the request body, set `accepts_product_review_abandoned_cart_emails` to `true` to enable Abandoned Cart Saver notifications. This will create a customer account optimized to receive Abandoned Cart Saver emails.\n\n   ```http\n   POST https://api.bigcommerce.com/stores/{{STORE_HASH}}/v3/customers\n   X-Auth-Token: {{ACCESS_TOKEN}}\n   Content-Type: application/json\n   Accept: application/json\n\n   [\n   {\n     \"email\": \"test_user@bigcommerce.com\",\n     \"first_name\": \"Jane\",\n     \"last_name\": \"Doe\",\n     \"addresses\": [\n         {\n           \"address1\": \"123 Main St\",\n           \"address2\": \"\",\n           \"address_type\": \"residential\",\n           \"city\": \"Austin\",\n           \"country_code\": \"US\",\n           \"first_name\": \"Jane\",\n           \"last_name\": \"Doe\",\n           \"phone\": \"512-111-0000\",\n           \"postal_code\": \"78701\",\n           \"state_or_province\": \"Texas\"\n         }\n       ],\n     \"accepts_product_review_abandoned_cart_emails\": true,\n     \"origin_channel_id\": 773240,\n     \"channel_ids\": [\n         773240\n       ]\n   }\n   ]\n   ```\n\n   [![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/customers-v3/customers/customerspost#requestrunner)\n\n2. Send a `POST` request to the [Create a Cart](https://developer.bigcommerce.com/api-reference/store-management/carts/cart/createacart) endpoint to create a cart. Include the customer ID and channel ID in the request body so that the URL inserted in transactional emails contains the correct site and routes.\n\n   ```http\n   POST https://api.bigcommerce.com/stores/{{STORE_HASH}}/v3/carts\n   X-Auth-Token: {{ACCESS_TOKEN}}\n   Content-Type: application/json\n   Accept: application/json\n\n   {\n     \"base_amount\": 25,\n     \"cart_amount\": 25,\n     \"channel_id\": 773240,\n     \"currency\": {\n       \"code\": \"USD\"\n     },\n     \"customer_id\": 2,\n     \"discount_amount\": 0,\n     \"line_items\": [\n         {\n           \"coupon_amount\": 0,\n           \"coupons\": [],\n           \"discount_amount\": 0,\n           \"discounts\": [],\n           \"extended_list_price\": 25,\n           \"extended_sale_price\": 25,\n           \"id\": \"5572bddf-f24d-4f4a-a1b6-29d4519494a6\",\n           \"image_url\": \"https://cdn11.bigcommerce.com/s-hg3tj17dfi/product_images/attribute_rule_images/8_thumb_1629748882.png\",\n           \"is_mutable\": true,\n           \"is_require_shipping\": true,\n           \"list_price\": 25,\n           \"name\": \"Short sleeve t-shirt\",\n           \"parent_id\": null,\n           \"product_id\": 114,\n           \"quantity\": 1,\n           \"sale_price\": 25,\n           \"sku\": \"5F6D82D6569C0_8579\",\n           \"taxable\": true,\n           \"url\": \"https://next-storefront2.mybigcommerce.com/ladies-short-sleeve-t-shirt/\",\n           \"variant_id\": 85\n         }\n       ],\n     \"locale\": \"en\",\n     \"tax_included\": false\n   }\n   ```\n\n   [![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/carts/cart/createacart#requestrunner)\n\n### Create cart with guest customer\n\n1. Send a `POST` request to the [Create a Cart](https://developer.bigcommerce.com/api-reference/store-management/carts/cart/createacart) endpoint to create a cart.\n\n   ```http\n   POST https://api.bigcommerce.com/stores/{{STORE_HASH}}/v3/carts\n   X-Auth-Token: {{ACCESS_TOKEN}}\n   Content-Type: application/json\n   Accept: application/json\n\n   {\n     \"channel_id\": 773240,\n     \"line_items\": [\n       {\n         \"quantity\": 5,\n         \"product_id\": 191\n       }\n     ]\n   }\n   ```\n\n   [![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/carts/cart/createacart#requestrunner)\n\n2. Send a `POST` request to the [Add Checkout Billing Address](https://developer.bigcommerce.com/api-reference/store-management/checkouts/checkout-billing-address/checkoutsbillingaddressbycheckoutidpost) endpoint to add checkout billing address. Include the email address in the request body so that the abandoned cart saver notification could be triggered.\n\n   ```http\n   POST https://api.bigcommerce.com/stores/{{STORE_HASH}}/v3/checkouts/{checkoutId}/billing-address\n   X-Auth-Token: {{ACCESS_TOKEN}}\n   Content-Type: application/json\n   Accept: application/json\n\n   {\n     \"first_name\": \"Jane\",\n     \"last_name\": \"Doe\",\n     \"email\": \"jane@example.com\",\n     \"address1\": \"123 Main Street\",\n     \"address2\": \"\",\n     \"city\": \"Austin\",\n     \"state_or_province\": \"Texas\",\n     \"state_or_province_code\": \"TX\",\n     \"country_code\": \"US\",\n     \"postal_code\": \"78751\",\n     \"phone\": \"1234567890\"\n   }\n   ```\n\n   [![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/checkouts/checkout-billing-address/checkoutsbillingaddressbycheckoutidpost#requestrunner)\n\nThis request creates a cart associated with the headless storefront without using BigCommerce's Optimized One-Page Checkout. Because the checkout is incomplete, the store treats this cart as abandoned and initiates the abandoned cart recovery sequence.\n\n## Resources\n\n- [Building Storefront Channels](https://developer.bigcommerce.com/api-docs/channels/tutorials/storefront)\n- [Open Checkout Quick Start](https://developer.bigcommerce.com/stencil-docs/customizing-checkout/open-checkout-quick-start)\n- [Selling Everywhere with Channel Manager](https://support.bigcommerce.com/s/article/Selling-Everywhere-with-Channel-Manager?language=en_US)\n- [Using the Abandoned Cart Saver](https://support.bigcommerce.com/s/article/Using-the-Abandoned-Cart-Saver?language=en_US)\n"}],"children":[]}}}}
