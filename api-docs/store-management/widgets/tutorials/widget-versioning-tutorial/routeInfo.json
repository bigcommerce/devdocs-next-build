{"path":"api-docs/store-management/widgets/tutorials/widget-versioning-tutorial","templateID":0,"sharedPropsHashes":{"nav":"Z2k7O5R","sidebarTree":"Z1Jm3fi","namespace":"Zd6xn0"},"localProps":{"version":"1.3","crumbs":[{"content":"API Docs","to":"/api-docs"},{"content":"Management APIs","to":"/api-docs/store-management"},{"content":"Widgets","to":"/api-docs/store-management/widgets"},{"content":"Tutorials","to":"/api-docs/store-management/widgets/tutorials"},{"content":"Widget Versioning Tutorial","to":"/api-docs/store-management/widgets/tutorials/widget-versioning-tutorial"}],"page":{"meta":{"title":"Widget Versioning Tutorial - Tutorials - Widgets - Management APIs - API Docs","url":"/api-docs/store-management/widgets/tutorials/widget-versioning-tutorial","description":"Widget Versioning\n\n\n\nOn this page\n\nCreate a widget template\n\nUpdate the widget template\n\nUpgrade the widget\n\nRelated resources\n\n\n\nThis article documents..."},"title":"Widget Versioning Tutorial","parsedPath":["pages","/api-docs","data","children",2,"data","children",11,"data","children",3,"data","children",1],"rootPagePath":"/api-docs","path":"/api-docs/store-management/widgets/tutorials/widget-versioning-tutorial","isSubpage":true,"route":{"path":"/widget-versioning-tutorial"},"data":{"blocks":[{"type":"text","data":"# Widget Versioning\n\n<div class=\"otp\" id=\"no-index\">\n\n### On this page\n- [Create a widget template](#create-a-widget-template)\n- [Update the widget template](#update-the-widget-template)\n- [Upgrade the widget](#upgrade-the-widget)\n- [Related resources](#related-resources)\n\n</div>\n\nThis article documents how to use [widget versioning](https://developer.bigcommerce.com/api-docs/store-management/widgets/overview#widget-versioning) to update a widget template without updating its widgets.\n\n###  Prerequisites\n\n* [A BigCommerce store](https://support.bigcommerce.com/s/article/Starting-a-Bigcommerce-Trial).\n* API `access_token` with `content modify` scope.\n* Knowledge of the [Widgets API](https://developer.bigcommerce.com/api-docs/storefront/widgets/widgets-overview).\n\n<div class=\"HubBlock--callout\">\n<div class=\"CalloutBlock--info\">\n<div class=\"HubBlock-content\">\n\n> ### Note\n> This tutorial uses [Cornerstone](https://github.com/bigcommerce/cornerstone) theme.\n\n</div>\n</div>\n</div>\n\n## Create a widget template\n\nTo create a widget template, send a `POST` request to [`v3/content/widget-templates`](https://developer.bigcommerce.com/api-reference/store-management/widgets/widget-template/createwidgettemplate).\n\n```http\nPOST /stores/{{store_hash}}/v3/content/widget-templates\nHost: api.bigcommerce.com\nX-Auth-Token: {{ACCESS_TOKEN}}\nContent-Type: application/json\nAccept: application/json\n\n{\n  \"name\": \"Simple Text\",\n  \"schema\": [\n    {\n      \"type\": \"tab\",\n      \"label\": \"Content\",\n      \"sections\": [\n        {\n          \"settings\": [\n            {\n              \"type\": \"text\",\n              \"label\": \"Text Content\",\n              \"id\": \"textContent\",\n              \"typeMeta\": {\n                \"maxLength\": 1000\n              }\n            }\n          ]\n        }\n      ]\n    }\n  ],\n  \"template\": \"<h1>{{textContent}}</h1>\"\n}\n```\n\n[![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/widgets/widget-template/createwidgettemplate#requestrunner)\n\n\n<div class=\"HubBlock--callout\">\n<div class=\"CalloutBlock--info\">\n<div class=\"HubBlock-content\">\n\n> ### Note\n> * Make a note of `uuid` and `current_version_uuid`. We will use them in the steps that follow.\n\n</div>\n</div>\n</div>\n\nYou can use [Page Builder](https://support.bigcommerce.com/s/article/Page-Builder), BigCommerce's storefront editing and customization tool, to view your widget template in the control panel. It will be displayed in the left pane under **Custom**.\n\n![Page Builder](https://raw.githubusercontent.com/bigcommerce/dev-docs/master/assets/images/widget-versioning-01.png \"Page Builder\")\n\n### Create a widget\n\nIn this tutorial, you will create and place a widget programmatically. To place your widget using Page Builder, drag and drop the widget template from the left pane onto the page.\n\nTo create a widget using the Widgets API, send a `POST` request to [`/v3/content/widgets`](https://developer.bigcommerce.com/api-reference/storefront/widgets-api/widget/createwidget). Replace the `widget_template_uuid` placeholder with the `uuid` from the [previous step](#create-a-widget-template).\n\n```http\nPOST /stores/{{STORE_HASH}}/v3/content/widgets\nHost: api.bigcommerce.com\nX-Auth-Token: {{ACCESS_TOKEN}}\nContent-Type: application/json\nAccept: application/json\n\n{\n  \"name\": \"Version 1 Widget\",\n  \"widget_configuration\": {\n    \"textContent\": \"Hello, World!\"\n  },\n  \"widget_template_uuid\": \"{your-widget-template-uuid}\"\n}\n```\n\n[![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/widgets/widget/createwidget#requestrunner)\n\nLook for `version_uuid` and `current_version_uuid` in the response. The widget's `version_uuid`should match the `current_version_uuid` of the widget template.\n\n```json\n{\n  \"data\": {\n    \"channel_id\": 1,\n    \"date_created\": \"2020-11-06T18:05:21.679Z\",\n    \"date_modified\": \"2020-11-06T18:05:21.679Z\",\n    \"description\": \"\",\n    \"name\": \"Version 1 Widget\",\n    \"uuid\": \"03ada835-fc01-4cf1-9c05-af86ee141cd5\",\n    \"version_uuid\": \"5bb17ca3-a8c3-4a5a-bbf1-18a2b9ee9ddd\", // value matches current_version_uuid\n    \"widget_configuration\": {...},\n    \"widget_template\": {\n      \"channel_id\": 1,\n      \"client_rerender\": false,\n      \"current_version_uuid\": \"5bb17ca3-a8c3-4a5a-bbf1-18a2b9ee9ddd\", // value matches version_uuid\n      \"date_created\": \"2020-11-06T18:04:34.817Z\",\n      \"date_modified\": \"2020-11-06T18:04:34.817Z\",\n      \"icon_name\": \"default\",\n      \"kind\": \"custom\",\n      \"name\": \"Simple Text\",\n      \"schema\": [...],\n      \"template\": \"<h1>{{textContent}}</h1>\",\n      \"uuid\": \"ee65e81f-a6a6-43a4-8d52-60bab87dbff3\"\n    }\n  },\n  \"meta\": {}\n}\n```\n\n### Place the widget\n\nYou can place the widget on the storefront by [creating a placement](https://developer.bigcommerce.com/api-reference/store-management/widgets/placement/createplacement). The following example uses the `home_below_featured_products` region. To get a list of all available regions, send a `GET` request to [`v3/content/regions`](https://developer.bigcommerce.com/api-reference/store-management/widgets/regions/getcontentregions).\n\nTo place your widget, send a `POST` request to [`/v3/content/placements`](https://developer.bigcommerce.com/api-reference/store-management/widgets/placement/createplacement). \n\n```http\nPOST /stores/{{STORE_HASH}}/v3/content/placements\nHost: api.bigcommerce.com\nX-Auth-Token: {{ACCESS_TOKEN}}\nContent-Type: application/json\nAccept: application/json\n\n{\n  \"widget_uuid\": \"{your-widget-uuid}\",\n  \"entity_id\": \"\",\n  \"template_file\": \"pages/home\",\n  \"status\": \"active\",\n  \"sort_order\": 1,\n  \"region\": \"home_below_featured_products\"\n}\n```\n\n[![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/widgets/placement/createplacement#requestrunner)\n\nThe widget should now be visible on your store's homepage under **Featured Products**.\n\n## Update the widget template\n\nThe `create_new_version` parameter controls whether widget updates are *forced* or *opt-in*. Omitting the `create_new_version` parameter or setting it to `false` will make it a *forced* update.\n\nTo create a new version of the widget template without affecting existing widgets, set `create_new_version` to `true` when sending a `PUT` request to [`/v3/content/widget-templates/{uuid}`](https://developer.bigcommerce.com/api-reference/store-management/widgets/widget-template/updatewidgettemplate). This will create a new widget template version record and associate that record to the `current_version_uuid`.\n\n```http\nPOST /stores/{{store_hash}}v3/content/widget-templates/{uuid}\nHost: api.bigcommerce.com\nX-Auth-Token: {{ACCESS_TOKEN}}\nContent-Type: application/json\nAccept: application/json\n\n{\n  \"name\": \"Red Text\",\n  \"schema\": [\n    {\n      \"type\": \"tab\",\n      \"label\": \"Content\",\n      \"sections\": [\n        {\n          \"settings\": [\n            {\n              \"type\": \"text\",\n              \"label\": \"Text Content\",\n              \"id\": \"textContent\",\n              \"typeMeta\": {\n                \"maxLength\": 1000\n              }\n            }\n          ]\n        }\n      ]\n    }\n  ],\n  \"template\": \"<h1 style='color:red;'>{{textContent}}</h1>\",\n  \"create_new_version\": true\n}\n```\n\n[![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/widgets/widget-template/updatewidgettemplate#requestrunner)\n\nSend a `GET` request to [`/v3/content/widgets/{uuid}`](https://developer.bigcommerce.com/api-reference/store-management/widgets/widget/getwidget) to retrieve your widget's data.\nYou will notice that `current_version_uuid` has changed and is now different from the widget's `version_uuid`. Although you have updated the widget template, the widget created using that template did not change.\n\n### Create a new widget\n\nAll widgets created after the update will be based on the most current version. Let's create another widget to test this functionality. \n\nSend a `POST` request to [`/v3/content/widgets`](https://developer.bigcommerce.com/api-reference/storefront/widgets-api/widget/createwidget) replacing the `widget_template_uuid` placeholder with your widget template `uuid`.\n\n```http\nPOST /stores/{{STORE_HASH}}/v3/content/widgets\nHost: api.bigcommerce.com\nX-Auth-Token: {{ACCESS_TOKEN}}\nContent-Type: application/json\nAccept: application/json\n\n{\n  \"name\": \"Version 2 Widget\",\n  \"widget_configuration\": {\n    \"textContent\": \"Hello, World!\"\n  },\n  \"widget_template_uuid\": \"{your-widget-template-uuid}\"\n}\n```\n\n[![Open in Request Runner](https://storage.googleapis.com/bigcommerce-production-dev-center/images/Open-Request-Runner.svg)](https://developer.bigcommerce.com/api-reference/store-management/widgets/widget/createwidget#requestrunner)\n\nTo display the new widget next to the old one, place it in the same region. In our case, it is `home_below_featured_products`. \n\nYou should now see two different widgets displayed below **Featured Products**.\n\n![Add a new widget](https://raw.githubusercontent.com/bigcommerce/dev-docs/master/assets/images/widget-versioning-02.png \"Add a new widget\")\n\n## Upgrade the widget\n\nTo upgrade the widget derived from the original widget template, send `\"upgrade\":true` in a `PUT` request to [`/v3/content/widgets/{uuid}`](https://developer.bigcommerce.com/api-reference/store-management/widgets/widget/updatewidget). This will push the widget up to the latest widget template version.\n\n![Upgrade the widget](https://raw.githubusercontent.com/bigcommerce/dev-docs/master/assets/images/widget-versioning-03.png \"Upgrade the widget\")\n\n<div class=\"HubBlock--callout\">\n<div class=\"CalloutBlock--info\">\n<div class=\"HubBlock-content\">\n\n> ### Note\n> * If the newer version of your widget template contains different schema settings, you need to provide the necessary configuration values along with the `upgrade` flag to make sure the widget is updated correctly. \n\n</div>\n</div>\n</div>\n\n## Related resources\n\n### Articles\n* [Widgets Overview](/api-docs/store-management/widgets/overview)\n* [Page Builder Overview](https://developer.bigcommerce.com/stencil-docs/page-builder/page-builder-overview)\n\n### Endpoints\n* [Widgets API](/api-reference/store-management/widgets)"}],"children":[]}}}}
