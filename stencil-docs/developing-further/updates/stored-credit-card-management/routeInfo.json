{"path":"stencil-docs/developing-further/updates/stored-credit-card-management","templateID":0,"sharedPropsHashes":{"nav":"Z2k7O5R","sidebarTree":"23J4Lj","namespace":"Zd6xn0"},"localProps":{"version":"1.3","crumbs":[{"content":"Stencil Docs","to":"/stencil-docs"},{"content":"Developing Further","to":"/stencil-docs/developing-further"},{"content":"Apply Updates","to":"/stencil-docs/developing-further/updates"},{"content":"Add Stored Payment Methods","to":"/stencil-docs/developing-further/updates/stored-credit-card-management"}],"page":{"meta":{"title":"Add Stored Payment Methods - Apply Updates - Developing Further - Stencil Docs","url":"/stencil-docs/developing-further/updates/stored-credit-card-management","description":"Stored Payment Methods\n\n\n\nOn This Page\n\nRequirements\n\nAdding Stored Credit Cards\n\nFAQ\n\nResources\n\n\n\nCornerstone release 2.6.0 added stored payment metho..."},"title":"Add Stored Payment Methods","parsedPath":["pages","/stencil-docs","data","children",6,"data","children",6,"data","children",0],"rootPagePath":"/stencil-docs","path":"/stencil-docs/developing-further/updates/stored-credit-card-management","isSubpage":true,"route":{"path":"/stored-credit-card-management"},"data":{"blocks":[{"type":"text","data":"# Stored Payment Methods\r\n\r\n<div class=\"otp\" id=\"no-index\">\r\n\r\n### On This Page\r\n- [Requirements](#requirements)\r\n- [Adding Stored Credit Cards](#adding-stored-credit-cards)\r\n- [FAQ](#faq)\r\n- [Resources](#resources)\r\n\r\n</div>\r\n\r\nCornerstone release [`2.6.0`](https://developer.bigcommerce.com/changelog#posts/cornerstone-2-6-0-release) added stored payment method management for saved credit cards to the customer `account.php` page. Cornerstone [`4.4.0`](https://developer.bigcommerce.com/changelog#posts/cornerstone-4-4-0-release) expands this functionality to include saving PayPal accounts via [PayPal powered by Braintree](https://support.bigcommerce.com/s/article/Connecting-with-PayPal-Powered-by-Braintree). This article contains instructions for manually applying the changes made in `4.4.0` to themes version `2.6.0 ` to `4.3.1`. For a full diff of the files to change, see [Pull Request #1603](https://github.com/bigcommerce/cornerstone/pull/1603/files). If you're developing on a theme older than version `2.6.0` you'll first need to apply the changes made in `2.6.0`; to do so, see [Stored Credit Card Management](https://developer.bigcommerce.com/legacy/stencil-themes/stored-credit-card-management). For theme update best practices, see [Theme Updates and Version Control](https://developer.bigcommerce.com/stencil-docs/developing-further/theme-updates-and-version-control).\r\n\r\n![Save PayPal Account](https://raw.githubusercontent.com/bigcommerce/dev-docs/master/assets/images/stored-credit-card-management02.png \"Save PayPal Account\")\r\n\r\n## Update `config.json`\r\n\r\nIn `config.json`, replace `account_payment_methods` in the `features` array with `account_payment_methods_v2` and add `csrf_protection`:\r\n\r\n```json\r\n{\r\n  \"name\": \"Cornerstone\",\r\n  \"version\": \"4.3.1\",\r\n  \"meta\": {\r\n    ...\r\n    \"features\": [\r\n      \"fully_responsive\",\r\n      \"mega_navigation\",\r\n      ...\r\n      \"csrf_protection\",        // <-- add csrf_protection\r\n      \"account_payment_methods\" // <-- replace with account_payment_methods_v2\r\n    ]\r\n  },\r\n```\r\n\r\nThen [add the `supported_payment_methods` array](https://github.com/leeBigCommerce/cornerstone/blob/54f5681a6a15cd8477c51c6db9eb54ea3eb40972/config.json#L325) and append `card` and `paypal` to it:\r\n\r\n```json\r\n    ...\r\n    \"supported_card_type_icons\": [\r\n      ...\r\n    ],\r\n    \"supported_payment_methods\": [ // <-- Add supported_payment_methods array\r\n      \"card\",                      // <-- whitelist card and paypal\r\n      \"paypal\"\r\n    ],\r\n    \"lazyload_mode\": \"lazyload+lqip\"\r\n  },\r\n  ...\r\n```\r\n\r\nThis will enable saving PayPal and credit card accounts (and other non credit card payment methods) on the theme.\r\n\r\nSee the full diff, refer to [Pull Request #1603](https://github.com/bigcommerce/cornerstone/pull/1603/files?file-filters%5B%5D=.html&file-filters%5B%5D=.json&file-filters%5B%5D=.md#diff-06b2d3b23dce96e1619d2b53d6c947ec).\r\n\r\n## Update `payment-methods-list.html`\r\nOnce the config changes listed above are made, a new version of the `payment_methods` object will be given to the template.\r\n\r\nTo use the updated object, apply the changes from [Pull Request #1603](https://github.com/bigcommerce/cornerstone/pull/1603/files?file-filters%5B%5D=.html) to `payment-methods-list.html`.\r\n\r\nOnce applied, saved PayPal accounts will be displayed in the payment method list:\r\n\r\n![Payment Method List](https://raw.githubusercontent.com/bigcommerce/dev-docs/master/assets/images/stored-credit-card-management01.png \"Payment Method List\")\r\n\r\n## Update `edit-payment-method.html`\r\nThe `customer.edit_stored_instrument` object has been lightly extended to include a `type` attribute.\r\n\r\nUsing `type`, we can show or hide fields based on the current instrument being `stored_card` or `stored_paypal_account`. The type is also posted back to the form handler in a hidden input so the handler can update the right kind of instrument accordingly.\r\n\r\nModify `edit-payment-method.html` to include changes from [Pull Request #1603](https://github.com/bigcommerce/cornerstone/pull/1603/files?file-filters%5B%5D=.html) to add the new user interface elements and behavior.\r\n\r\n## Update `_paymentMethods.scss`\r\n\r\nTo style the newly added UI elements, update `_paymentMethods.scss` with the changes from [Pull Request #1603](https://github.com/bigcommerce/cornerstone/pull/1603/files?file-filters%5B%5D=#diff-1c33ed0c69f228483a39fce2616e1942).\r\n\r\n## Add PayPal Logo\r\n\r\nIncluded in the changes to `payment-methods-list.html` is a PayPal logo that's displayed on the payment method cards:\r\n\r\n```\r\n<img class=\"methodHeader-icon\" src=\"{{cdn 'img/payment-methods/paypal.svg'}}\" alt=\"{{lang 'account.payment_methods.paypal'}}\" title=\"{{lang 'account.payment_methods.paypal'}}\">\r\n```\r\n\r\nDownload the `.svg` and save it to `assets/img/payment-methods`:\r\n\r\n```bash\r\ncd assets/img/payment-methods/paypal.svg\r\ncurl -O https://raw.githubusercontent.com/leeBigCommerce/cornerstone/54f5681a6a15cd8477c51c6db9eb54ea3eb40972/assets/img/payment-methods/paypal.svg\r\n```\r\n\r\n## Update `en.json`\r\nAt minimum, a translation for the `en` needs to be added to `lang/en.json: [Pull Request #1603](https://github.com/bigcommerce/cornerstone/pull/1603/files?file-filters%5B%5D=.html&file-filters%5B%5D=.json&file-filters%5B%5D=.md#diff-b0d4c1fc9d8d2a5a213b27a72cf6c9fe). Add translations for other locales as needed.\r\n\r\n## FAQ\r\n**Where is the card data stored?**\r\n\r\nCard data is stored securely with the payment gateway.\r\n\r\n**Is storing credit cards PCI compliant?**\r\n\r\nCard data is stored securely with the payment gateway. The BigCommerce store is NOT storing the payment data.\r\n\r\n**Can shoppers modify their stored card?**\r\n\r\nAfter adding a card, shoppers can modify the billing address. To modify other the other details, shoppers will need to delete and re-add the card.\r\n\r\n## Resources\r\n\r\n### Related Articles\r\n* [Payments API](https://developer.bigcommerce.com/api-docs/payments/payments-api-overview)\r\n* [Enabling Stored Cards](https://support.bigcommerce.com/s/article/Enabling-Stored-Credit-Cards) (BigCommerce Knowledge Base)\r\n* [The Complete Guide to Checkout Customization on BigCommerce](https://medium.com/bigcommerce-developer-blog/the-complete-guide-to-checkout-customization-on-bigcommerce-6b566bc36fa9) (Developer Blog)\r\n"}],"children":[]}}}}
